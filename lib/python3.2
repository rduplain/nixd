#!/bin/bash

ARCHIVE=virtualenv-1.8.4.tar.gz
UNPACKED=virtualenv-1.8.4
PREFIX=$NIXD_OPT/python3.2

check() {
    nixd_ls $PREFIX/bin/python
    nixd_ls $PREFIX/bin/pip
}

resources() {
    echo http://pypi.python.org/packages/source/v/virtualenv/$ARCHIVE
}

pretest() {
    nixd check_for_program python3.2
}

install() {
    tar -xzf $ARCHIVE
    VIRTUALENV_PY=`pwd`/$UNPACKED/virtualenv.py
    nixd_echo "Ensuring virtualenv.py is unpacked..."
    nixd_ls $VIRTUALENV_PY
    nixd_echo "Installing virtualenv to $PREFIX..."
    cd $NIXD_OPT
    python3.2 $VIRTUALENV_PY --distribute --no-site-packages python3.2
}

nixd_run "$@"
